<!DOCTYPE html>
<html lang="en" data-theme="polite">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polite Coaching Centre - Complete Exam System</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Complete exam management system for Polite Coaching Centre">
    <meta name="theme-color" content="#2c3e50">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Polite Exam">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- DaisyUI Component Library -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.19/dist/full.min.css" rel="stylesheet" type="text/css" />
    
    <!-- Tailwind Config for DaisyUI -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2c3e50',
                        secondary: '#3498db',
                        accent: '#9b59b6',
                        success: '#27ae60',
                        warning: '#f39c12',
                        danger: '#e74c3c',
                        info: '#17a2b8',
                    },
                    animation: {
                        'bounce-slow': 'bounce 3s linear infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            },
            daisyui: {
                themes: [
                    {
                        polite: {
                            'primary': '#2563eb',          // Modern vibrant blue
                            'primary-content': '#ffffff',
                            'secondary': '#7c3aed',        // Purple
                            'secondary-content': '#ffffff',
                            'accent': '#f59e0b',           // Amber
                            'accent-content': '#ffffff',
                            'neutral': '#1f2937',          // Dark gray
                            'neutral-content': '#ffffff',
                            'base-100': '#ffffff',         // White background
                            'base-200': '#f3f4f6',         // Light gray
                            'base-300': '#e5e7eb',         // Medium gray
                            'base-content': '#1f2937',     // Dark text
                            'info': '#0ea5e9',             // Sky blue
                            'info-content': '#ffffff',
                            'success': '#10b981',          // Emerald green
                            'success-content': '#ffffff',
                            'warning': '#f59e0b',          // Amber
                            'warning-content': '#ffffff',
                            'error': '#ef4444',            // Red
                            'error-content': '#ffffff',
                        }
                    }
                ],
                darkTheme: false,
                base: true,
                styled: true,
                utils: true,
            }
        }
    </script>
    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="styles.css">

    <!-- Flatpickr CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    <!-- Flatpickr JS -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <!-- KaTeX for Math Rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- Chart.js for Graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <script src="api-integration.js"></script>
</head>
<body>
    <div class="container">
        <header class="bg-gradient-to-r from-primary via-secondary to-accent text-white relative shadow-2xl">
            <a href="#" id="admin-link" class="admin-link absolute top-4 right-4 text-warning hover:text-warning-content transition-colors font-semibold text-sm">
                🔐 Admin Login
            </a>
            <div id="candidate-nav-buttons" class="candidate-nav-buttons absolute top-4 left-4 flex gap-2">
                <button id="header-back-btn" class="btn btn-ghost btn-sm text-white hover:bg-white/20">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back
                </button>
                <button id="header-logout-btn" class="btn btn-ghost btn-sm text-white hover:bg-error/20 hover:text-error-content">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    Logout
                </button>
            </div>
            <div class="text-center py-8 px-4">
                <div class="logo text-5xl font-extrabold tracking-wide mb-3 drop-shadow-2xl animate-pulse-slow">
                    🎓 POLITE COACHING CENTRE
                </div>
                <div class="subtitle text-lg opacity-95 font-medium">
                    Complete Exam Preparation for Banking, SSC, Railways & Government Jobs
                </div>
            </div>
        </header>

        <div class="content">
            <!-- Hero Landing Page -->
            <div id="hero-landing" class="screen active">
                <div class="hero min-h-[600px] bg-gradient-to-br from-primary via-secondary to-accent rounded-2xl">
                    <div class="hero-content text-center">
                        <div class="max-w-2xl">
                            <div class="text-7xl mb-6 animate-bounce">🎓</div>
                            <h1 class="text-6xl font-bold text-white mb-6 drop-shadow-2xl">
                                Excel in Your Exams!
                            </h1>
                            <p class="text-xl text-white/90 mb-8 leading-relaxed">
                                Comprehensive preparation for Banking, SSC, Railways & Government Jobs
                            </p>
                            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                                <button id="start-exam-hero-btn" class="btn btn-lg btn-success text-white gap-2 shadow-2xl hover:scale-105 transition-transform">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                    </svg>
                                    Let's Go! Take an Exam
                                </button>
                            </div>
                            <div class="divider text-white/70 my-8">OR</div>
                            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                                <button id="signin-btn" class="btn btn-outline btn-lg text-white border-white hover:bg-white hover:text-primary hover:border-white">
                                    Sign In
                                </button>
                                <button id="signup-btn" class="btn btn-lg bg-white text-primary hover:bg-base-200 hover:text-primary border-0">
                                    Create Account
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Candidate Signup Screen -->
            <div id="candidate-signup-screen" class="screen">
                <a href="#" id="back-to-hero-from-signup" class="btn btn-ghost btn-sm gap-2 mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back
                </a>
                <div class="card bg-base-100 shadow-2xl max-w-2xl mx-auto">
                    <div class="card-body">
                        <h2 class="card-title text-3xl font-bold text-primary justify-center mb-6">Create Your Account</h2>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Full Name *</span>
                            </label>
                            <input type="text" id="signup-name" placeholder="Enter your full name" class="input input-bordered input-primary" required>
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Email Address *</span>
                            </label>
                            <input type="email" id="signup-email" placeholder="your@email.com" class="input input-bordered input-primary" required>
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Mobile Number (Optional)</span>
                            </label>
                            <input type="tel" id="signup-mobile" placeholder="10-digit mobile number" class="input input-bordered">
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Password *</span>
                            </label>
                            <input type="password" id="signup-password" placeholder="Create a strong password" class="input input-bordered input-primary" required>
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Confirm Password *</span>
                            </label>
                            <input type="password" id="signup-confirm-password" placeholder="Re-enter your password" class="input input-bordered input-primary" required>
                        </div>
                        <div class="alert alert-info mt-4">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <span>A verification link will be sent to your email</span>
                        </div>
                        <div class="form-control mt-6">
                            <button id="signup-submit-btn" class="btn btn-success btn-lg text-white">Create Account</button>
                        </div>
                        <div class="divider">Already have an account?</div>
                        <button id="goto-signin-link" class="btn btn-outline btn-primary">Sign In</button>
                    </div>
                </div>
            </div>

            <!-- Email Verification Success Screen -->
            <div id="verification-success-screen" class="screen">
                <div class="card bg-base-100 shadow-2xl max-w-xl mx-auto">
                    <div class="card-body text-center">
                        <div class="text-8xl mb-6">✅</div>
                        <h2 class="card-title text-4xl font-bold text-success justify-center mb-4">Email Verified!</h2>
                        <p class="text-base-content/70 text-lg mb-6">
                            Your email has been verified successfully. You can now login to your account.
                        </p>
                        <button id="goto-signin-after-verify" class="btn btn-success btn-lg text-white">Go to Sign In</button>
                    </div>
                </div>
            </div>

            <!-- Verification Pending Screen -->
            <div id="verification-pending-screen" class="screen">
                <div class="card bg-base-100 shadow-2xl max-w-xl mx-auto">
                    <div class="card-body text-center">
                        <div class="text-8xl mb-6">📧</div>
                        <h2 class="card-title text-3xl font-bold text-primary justify-center mb-4">Check Your Email!</h2>
                        <p class="text-base-content/70 mb-2">
                            We've sent a verification link to:
                        </p>
                        <p class="font-bold text-primary text-lg mb-6" id="pending-verification-email"></p>
                        <div class="alert alert-info">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <span>Click the link in the email to verify your account. Once verified, you can login.</span>
                        </div>
                        <button id="resend-verification-btn" class="btn btn-success btn-lg text-white mt-6">Resend Verification Email</button>
                        <div class="divider">Already verified?</div>
                        <button id="goto-signin-from-pending" class="btn btn-outline btn-primary">Sign In</button>
                    </div>
                </div>
            </div>

            <!-- Candidate Login Screen -->
            <div id="candidate-signin-screen" class="screen">
                <a href="#" id="back-to-hero-from-signin" class="btn btn-ghost btn-sm gap-2 mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back
                </a>
                <div class="card bg-base-100 shadow-2xl max-w-xl mx-auto">
                    <div class="card-body">
                        <div class="text-center mb-6">
                            <div class="text-6xl mb-4">👋</div>
                            <h2 class="card-title text-3xl font-bold text-primary justify-center">Welcome Back!</h2>
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Email Address *</span>
                            </label>
                            <input type="email" id="signin-email" placeholder="your@email.com" class="input input-bordered input-primary" required>
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Password *</span>
                            </label>
                            <input type="password" id="signin-password" placeholder="Enter your password" class="input input-bordered input-primary" required>
                            <label class="label">
                                <a id="forgot-password-link" class="label-text-alt link link-hover link-primary">Forgot password?</a>
                            </label>
                        </div>
                        <div class="form-control mt-6">
                            <button id="signin-submit-btn" class="btn btn-primary btn-lg text-white">Sign In</button>
                        </div>
                        <div class="divider">Don't have an account?</div>
                        <button id="goto-signup-link" class="btn btn-outline btn-secondary">Create Account</button>
                    </div>
                </div>
            </div>

            <!-- Forgot Password Screen -->
            <div id="forgot-password-screen" class="screen">
                <a href="#" id="back-to-signin-from-forgot" class="btn btn-ghost btn-sm gap-2 mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back to Sign In
                </a>
                <div class="card bg-base-100 shadow-2xl max-w-xl mx-auto">
                    <div class="card-body">
                        <div class="text-center mb-6">
                            <div class="text-6xl mb-4">🔐</div>
                            <h2 class="card-title text-3xl font-bold text-primary justify-center">Reset Your Password</h2>
                            <p class="text-base-content/70 mt-4">
                                Enter your email address and we'll generate a new temporary password for you.
                            </p>
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Email Address *</span>
                            </label>
                            <input type="email" id="forgot-email" placeholder="your@email.com" class="input input-bordered input-primary" required>
                        </div>
                        <div class="form-control mt-6">
                            <button id="reset-password-btn" class="btn btn-success btn-lg text-white">Reset Password</button>
                        </div>
                        <div id="reset-result" class="alert alert-success mt-6" style="display: none;">
                            <div class="flex flex-col gap-4 w-full">
                                <div class="flex items-start gap-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                    <div class="flex-1">
                                        <h3 class="font-bold">Password Reset Successful!</h3>
                                        <div class="text-sm">Your new temporary password is:</div>
                                    </div>
                                </div>
                                <div class="bg-base-100 p-4 rounded-lg">
                                    <div class="font-mono text-2xl font-bold text-center tracking-wider" id="new-temp-password"></div>
                                </div>
                                <div class="text-sm opacity-80">
                                    Please save this password and use it to sign in. We recommend changing it after logging in.
                                </div>
                                <button id="goto-signin-after-reset" class="btn btn-success text-white">Go to Sign In</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Candidate Dashboard -->
            <div id="candidate-dashboard" class="screen">
                <!-- Header with Logout -->
                <div class="flex justify-between items-center mb-8">
                    <div>
                        <h2 class="text-4xl font-bold text-primary mb-2">Welcome, <span id="dashboard-name"></span>! 👋</h2>
                        <p class="text-base-content/70">Track your progress and continue your exam preparation</p>
                    </div>
                    <a href="#" id="candidate-logout-link" class="btn btn-error btn-outline gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        Logout
                    </a>
                </div>

                <!-- Profile Card -->
                <div class="card bg-gradient-to-br from-primary to-secondary text-white shadow-2xl mb-8">
                    <div class="card-body">
                        <div class="flex flex-col md:flex-row items-center md:items-start gap-6">
                            <!-- Profile Image -->
                            <div class="relative">
                                <div id="profile-image-display" class="avatar placeholder">
                                    <div class="bg-white text-primary rounded-full w-24 h-24 ring ring-white ring-offset-base-100 ring-offset-2">
                                        <span id="profile-initials" class="text-4xl font-bold"></span>
                                    </div>
                                </div>
                                <label for="profile-image-input" class="absolute bottom-0 right-0 btn btn-success btn-circle btn-sm border-2 border-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                                    </svg>
                                </label>
                                <input type="file" id="profile-image-input" accept="image/*" class="hidden">
                            </div>
                            <!-- Profile Info -->
                            <div class="flex-1 text-center md:text-left">
                                <h3 class="text-2xl font-bold mb-2" id="profile-name-display"></h3>
                                <div class="space-y-1 opacity-90">
                                    <div class="flex items-center justify-center md:justify-start gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                        </svg>
                                        <span id="dashboard-email"></span>
                                    </div>
                                    <div class="flex items-center justify-center md:justify-start gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                        </svg>
                                        <span id="dashboard-mobile"></span>
                                        <a href="#" id="edit-mobile-link" class="link link-hover ml-2">Edit</a>
                                    </div>
                                </div>
                            </div>
                            <!-- Edit Button -->
                            <div>
                                <button id="edit-profile-btn" class="btn btn-white text-primary gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                    </svg>
                                    Edit Profile
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="stats stats-vertical lg:stats-horizontal shadow-xl w-full mb-8">
                    <div class="stat bg-gradient-to-br from-info to-info-content text-white">
                        <div class="stat-figure text-white/50">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                        </div>
                        <div class="stat-title text-white/80">Total Exams</div>
                        <div class="stat-value" id="total-exams-given">0</div>
                        <div class="stat-desc text-white/70">Completed assessments</div>
                    </div>

                    <div class="stat bg-gradient-to-br from-success to-success-content text-white">
                        <div class="stat-figure text-white/50">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                            </svg>
                        </div>
                        <div class="stat-title text-white/80">Average Score</div>
                        <div class="stat-value" id="average-score">0</div>
                        <div class="stat-desc text-white/70">Keep improving!</div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex flex-col sm:flex-row gap-4 mb-8">
                    <button id="take-exam-dashboard-btn" class="btn btn-success btn-lg flex-1 text-white gap-2 hover:scale-105 transition-transform">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                        </svg>
                        Take a New Exam
                    </button>
                    <button id="change-password-btn" class="btn btn-accent btn-lg flex-1 text-white gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
                        </svg>
                        Change Password
                    </button>
                </div>

                <!-- Exam History Section -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body">
                        <h3 class="card-title text-2xl text-primary mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Your Exam History
                        </h3>
                        <div id="exam-history-container">
                            <div class="text-center py-12">
                                <div class="text-7xl mb-4">📝</div>
                                <p class="text-base-content/70 text-lg">No exams taken yet. Start your first exam!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Edit Profile Modal -->
            <div id="edit-profile-modal" class="modal-overlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
                <div class="modal-content" style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3 style="color: var(--primary); margin: 0;">Edit Profile</h3>
                        <button id="close-profile-modal" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #999;">&times;</button>
                    </div>
                    <div class="form-group">
                        <label>Profile Image</label>
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div id="modal-profile-preview" style="width: 80px; height: 80px; border-radius: 50%; background: var(--secondary); display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem; overflow: hidden;"></div>
                            <div>
                                <label for="modal-profile-image" style="display: inline-block; background: var(--secondary); color: white; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-size: 0.9rem;">Choose Image</label>
                                <input type="file" id="modal-profile-image" accept="image/*" style="display: none;">
                                <p style="font-size: 0.8rem; color: #999; margin-top: 5px;">Max size: 500KB</p>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="edit-profile-name">Full Name</label>
                        <input type="text" id="edit-profile-name" placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label for="edit-profile-mobile">Mobile Number</label>
                        <input type="tel" id="edit-profile-mobile" placeholder="10-digit mobile number">
                    </div>
                    <button id="save-profile-btn" class="success-btn">Save Changes</button>
                </div>
            </div>

            <!-- Change Password Modal -->
            <div id="change-password-modal" class="modal-overlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
                <div class="modal-content" style="background: white; border-radius: 15px; padding: 30px; max-width: 450px; width: 90%;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3 style="color: var(--primary); margin: 0;">Change Password</h3>
                        <button id="close-password-modal" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #999;">&times;</button>
                    </div>
                    <div class="form-group">
                        <label for="current-password">Current Password *</label>
                        <input type="password" id="current-password" placeholder="Enter current password">
                    </div>
                    <div class="form-group">
                        <label for="new-password">New Password *</label>
                        <input type="password" id="new-password" placeholder="Enter new password (min 6 characters)">
                    </div>
                    <div class="form-group">
                        <label for="confirm-new-password">Confirm New Password *</label>
                        <input type="password" id="confirm-new-password" placeholder="Re-enter new password">
                    </div>
                    <button id="save-password-btn" class="success-btn">Change Password</button>
                </div>
            </div>

            <!-- Admin Login Screen -->
            <div id="admin-login-screen" class="screen">
                <a href="#" id="back-to-hero-from-admin" class="btn btn-ghost btn-sm gap-2 mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back
                </a>
                <div class="card bg-base-100 shadow-2xl max-w-xl mx-auto border-2 border-warning">
                    <div class="card-body">
                        <div class="text-center mb-6">
                            <div class="text-6xl mb-4">🔐</div>
                            <h2 class="card-title text-3xl font-bold text-warning justify-center">Admin Access</h2>
                            <p class="text-base-content/70 mt-2">Authorized personnel only</p>
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Username</span>
                            </label>
                            <input type="text" id="admin-username" placeholder="Enter admin username" class="input input-bordered input-warning">
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Password</span>
                            </label>
                            <input type="password" id="admin-password" placeholder="Enter admin password" class="input input-bordered input-warning">
                        </div>
                        <p class="error text-error text-sm text-center mt-2" id="admin-login-error"></p>
                        <div class="form-control mt-6">
                            <button id="admin-login-btn" class="btn btn-warning btn-lg text-white gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                                </svg>
                                Login to Admin Panel
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Panel -->
            <div id="admin-panel" class="screen">
                <!-- Header with Logout -->
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8">
                    <div>
                        <h2 class="text-4xl font-bold text-warning mb-2">Admin Dashboard</h2>
                        <p class="text-base-content/70">Manage your exam system efficiently</p>
                    </div>
                    <button id="logout-btn" class="btn btn-error gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        Logout
                    </button>
                </div>

                <!-- System Status -->
                <div class="card bg-gradient-to-br from-info to-info-content text-white shadow-xl mb-8">
                    <div class="card-body">
                        <h3 class="card-title text-2xl mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                            </svg>
                            System Status
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div id="db-status-item" class="bg-white/10 rounded-lg p-4 backdrop-blur-sm">
                                <div class="flex items-center gap-3">
                                    <div class="text-4xl">☁️</div>
                                    <div class="flex-1">
                                        <div class="font-semibold text-white/90">Airtable Database</div>
                                        <div id="db-status-text" class="text-white font-bold">✅ Connected</div>
                                    </div>
                                </div>
                            </div>
                            <div id="gemini-status-item" class="bg-white/10 rounded-lg p-4 backdrop-blur-sm">
                                <div class="flex items-center gap-3">
                                    <div class="text-4xl">🤖</div>
                                    <div class="flex-1">
                                        <div class="font-semibold text-white/90">Gemini AI</div>
                                        <div id="gemini-status-text" class="text-white font-bold">✅ Active</div>
                                    </div>
                                </div>
                            </div>
                            <div id="ocr-status-item" class="bg-white/10 rounded-lg p-4 backdrop-blur-sm">
                                <div class="flex items-center gap-3">
                                    <div class="text-4xl">📸</div>
                                    <div class="flex-1">
                                        <div class="font-semibold text-white/90">OCR Service</div>
                                        <div id="ocr-status-text" class="text-white font-bold">✅ Ready</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
                    <button class="btn btn-lg btn-warning text-white gap-2 hover:scale-105 transition-transform" id="question-bank-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                        </svg>
                        Question Bank
                    </button>
                    <button class="btn btn-lg btn-warning text-white gap-2 hover:scale-105 transition-transform" id="create-exam-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                        </svg>
                        Create New Exam
                    </button>
                    <button class="btn btn-lg btn-warning text-white gap-2 hover:scale-105 transition-transform" id="view-results-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                        View Results
                    </button>
                    <button class="btn btn-lg btn-accent text-white gap-2 hover:scale-105 transition-transform" id="upload-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        Upload Question Paper
                    </button>
                    <button class="btn btn-lg btn-secondary text-white gap-2 hover:scale-105 transition-transform" id="ai-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        AI Question Generator
                    </button>
                    <button class="btn btn-lg btn-error text-white gap-2 hover:scale-105 transition-transform" id="clear-cache-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                        Clear All Cache
                    </button>
                </div>


                <!-- Question Bank Section -->
                <div id="question-bank-section" class="hidden">
                    <h3 style="margin: 0 0 15px 0; color: var(--secondary);">Question Bank</h3>

                    <!-- Stats Bar -->
                    <div id="question-bank-stats" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 10px 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; color: white;">
                        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                            <span>📊 Total: <strong id="total-questions-count">0</strong></span>
                            <span>✅ Selected: <strong id="selected-questions-count">0</strong></span>
                            <span>📄 Showing: <strong id="showing-questions-count">0</strong></span>
                            <span style="background: rgba(255,255,255,0.2); padding: 2px 10px; border-radius: 12px;">🛒 Cart: <strong id="cart-questions-count">0</strong></span>
                        </div>
                        <div style="font-size: 0.85rem; opacity: 0.9;">
                            Scroll down to load more questions
                        </div>
                    </div>

                    <!-- Search and Filter Row -->
                    <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                        <input type="text" id="question-search-input" placeholder="🔍 Search questions..." style="flex: 1; min-width: 200px; padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.95rem;">
                        <select id="question-filter-subject" style="padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.95rem; min-width: 120px;">
                            <option value="">All Subjects</option>
                            <option value="Quantitative Aptitude">Quantitative Aptitude</option>
                            <option value="Reasoning Ability">Reasoning Ability</option>
                            <option value="English Language">English Language</option>
                            <option value="General Awareness">General Awareness</option>
                            <option value="Current Affairs">Current Affairs</option>
                            <option value="History">History</option>
                            <option value="Geography">Geography</option>
                            <option value="Political Science">Political Science</option>
                            <option value="Economics">Economics</option>
                            <option value="Constitution">Constitution</option>
                            <option value="Law">Law</option>
                            <option value="Mathematics">Mathematics</option>
                            <option value="Science">Science</option>
                            <option value="Polity">Polity</option>
                            <option value="Banking Awareness">Banking Awareness</option>
                            <option value="Computer Knowledge">Computer Knowledge</option>
                            <option value="Descriptive Writing">Descriptive Writing</option>
                            <option value="Data Interpretation">Data Interpretation</option>
                            <option value="Logical Reasoning">Logical Reasoning</option>
                            <option value="Analytical Ability">Analytical Ability</option>
                            <option value="Verbal Ability">Verbal Ability</option>
                            <option value="Technical Subjects">Technical Subjects</option>
                            <option value="Legal Reasoning">Legal Reasoning</option>
                            <option value="Pedagogy">Pedagogy</option>
                            <option value="Others">Others</option>
                        </select>
                        <select id="question-filter-difficulty" style="padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.95rem; min-width: 120px;">
                            <option value="">All Difficulty</option>
                            <option value="Easy">Easy</option>
                            <option value="Medium">Medium</option>
                            <option value="Hard">Hard</option>
                        </select>
                    </div>

                    <!-- Action Buttons Row -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 12px; background: #f8f9fa; border-radius: 8px; flex-wrap: wrap; gap: 10px;">
                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <button id="select-all-questions-btn" style="background: #3498db; color: white; padding: 6px 12px; font-size: 0.8rem; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
                                ☑️ Select All
                            </button>
                            <button id="deselect-all-questions-btn" style="background: #95a5a6; color: white; padding: 6px 12px; font-size: 0.8rem; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
                                ☐ Deselect All
                            </button>
                            <button id="bulk-delete-questions-btn" style="background: #e74c3c; color: white; padding: 6px 12px; font-size: 0.8rem; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
                                🗑️ Delete Selected
                            </button>
                            <button id="sanitize-question-bank-btn" style="background: #9b59b6; color: white; padding: 6px 12px; font-size: 0.8rem; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
                                🧹 Sanitize (Remove Duplicates)
                            </button>
                            <button id="export-questions-btn" style="background: #27ae60; color: white; padding: 6px 12px; font-size: 0.8rem; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
                                📥 Export CSV
                            </button>
                        </div>
                        <button id="toggle-add-question-btn" style="background: var(--success); padding: 8px 16px; font-size: 0.9rem; border: none; border-radius: 5px; cursor: pointer; font-weight: 600;">
                            ➕ Add New Question
                        </button>
                    </div>

                    <!-- Add Question Form (Initially Hidden) -->
                    <div id="add-question-form" class="hidden" style="background: #f0f8ff; padding: 20px; border-radius: 10px; margin-bottom: 25px; border: 2px solid var(--primary);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <h4 style="margin: 0; color: var(--primary);">Add New Question</h4>
                                <a href="#" id="math-syntax-help-link" style="color: var(--secondary); font-size: 0.85rem; text-decoration: none; background: #e3f2fd; padding: 4px 10px; border-radius: 15px; display: flex; align-items: center; gap: 5px;" title="Click to see how to add math, images & graphs">
                                    <span style="font-size: 1rem;">📐</span> Math & Image Syntax Help
                                </a>
                            </div>
                            <button id="close-add-question-btn" style="background: #e74c3c; color: white; padding: 5px 12px; border-radius: 5px; border: none; cursor: pointer; font-size: 0.85rem;">✖ Close</button>
                        </div>

                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <div class="form-group" style="flex: 1; min-width: 150px;">
                                <label>Subject</label>
                                <select id="question-subject">
                                    <option value="Quantitative Aptitude">Quantitative Aptitude</option>
                                    <option value="Reasoning Ability">Reasoning Ability</option>
                                    <option value="English Language">English Language</option>
                                    <option value="General Awareness">General Awareness</option>
                                    <option value="Current Affairs">Current Affairs</option>
                                    <option value="History">History</option>
                                    <option value="Geography">Geography</option>
                                    <option value="Political Science">Political Science</option>
                                    <option value="Economics">Economics</option>
                                    <option value="Constitution">Constitution</option>
                                    <option value="Law">Law</option>
                                    <option value="Mathematics">Mathematics</option>
                                    <option value="Science">Science</option>
                                    <option value="Polity">Polity</option>
                                    <option value="Banking Awareness">Banking Awareness</option>
                                    <option value="Computer Knowledge">Computer Knowledge</option>
                                    <option value="Descriptive Writing">Descriptive Writing</option>
                                    <option value="Data Interpretation">Data Interpretation</option>
                                    <option value="Logical Reasoning">Logical Reasoning</option>
                                    <option value="Analytical Ability">Analytical Ability</option>
                                    <option value="Verbal Ability">Verbal Ability</option>
                                    <option value="Technical Subjects">Technical Subjects</option>
                                    <option value="Legal Reasoning">Legal Reasoning</option>
                                    <option value="Pedagogy">Pedagogy</option>
                                    <option value="Others">Others</option>
                                </select>
                            </div>
                            <div class="form-group" style="flex: 1; min-width: 150px;">
                                <label>Difficulty</label>
                                <select id="question-difficulty">
                                    <option value="Easy">Easy</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Hard">Hard</option>
                                </select>
                            </div>
                        </div>

                        <!-- Question Type Selection -->
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label>Question Type</label>
                            <select id="question-type" onchange="handleQuestionTypeChange()">
                                <option value="standalone">Standalone Question</option>
                                <option value="parent-child">Parent-child Question (Passage with Sub-questions)</option>
                            </select>
                        </div>

                        <!-- Standalone Question Info -->
                        <div id="standalone-question-info" style="background: #e3f2fd; border: 1px solid #2196f3; border-radius: 8px; padding: 12px; margin-bottom: 15px;">
                            <div style="color: #1565c0; font-weight: 600; margin-bottom: 5px;">📝 Standalone Question</div>
                            <div style="color: #666; font-size: 0.9rem;">A single MCQ with 4 options. Marks: +1 correct, -0.25 wrong, 0 unanswered.</div>
                        </div>

                        <!-- Parent-child Question Info -->
                        <div id="parent-child-question-info" style="display: none; background: #fff3e0; border: 1px solid #ff9800; border-radius: 8px; padding: 12px; margin-bottom: 15px;">
                            <div style="color: #e65100; font-weight: 600; margin-bottom: 5px;">📋 Parent-child Question</div>
                            <div style="color: #666; font-size: 0.9rem;">A passage/scenario with multiple sub-questions. The parent (passage) is not scored. Each child question is scored individually.</div>
                        </div>

                        <!-- Standalone Question Form -->
                        <div id="standalone-form-container">
                            <div class="form-group">
                                <label>Question Text</label>
                                <textarea id="question-text" rows="3" placeholder="Enter the question here..."></textarea>
                            </div>
                            <div id="question-options-container">
                                <div class="form-group">
                                    <label>Option A</label>
                                    <input type="text" id="option-a" placeholder="Option A">
                                </div>
                                <div class="form-group">
                                    <label>Option B</label>
                                    <input type="text" id="option-b" placeholder="Option B">
                                </div>
                                <div class="form-group">
                                    <label>Option C</label>
                                    <input type="text" id="option-c" placeholder="Option C">
                                </div>
                                <div class="form-group">
                                    <label>Option D</label>
                                    <input type="text" id="option-d" placeholder="Option D">
                                </div>
                                <div class="form-group">
                                    <label>Correct Answer</label>
                                    <select id="correct-answer">
                                        <option value="0">A</option>
                                        <option value="1">B</option>
                                        <option value="2">C</option>
                                        <option value="3">D</option>
                                    </select>
                                </div>
                            </div>
                            <button id="add-question-btn">Add Question to Bank</button>
                        </div>

                        <!-- Parent-child Question Form -->
                        <div id="parent-child-form-container" style="display: none;">
                            <!-- Parent Question Section -->
                            <div style="background: #fff8e1; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107; margin-bottom: 15px;">
                                <h5 style="margin: 0 0 10px 0; color: #856404;">📖 Parent Question (Passage/Scenario)</h5>
                                <div class="form-group">
                                    <label>Passage/Scenario Text</label>
                                    <textarea id="parent-question-text" rows="6" placeholder="Enter the passage, scenario, or context that the sub-questions will refer to..."></textarea>
                                </div>
                            </div>

                            <!-- Child Questions Section -->
                            <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50; margin-bottom: 15px;">
                                <h5 style="margin: 0 0 10px 0; color: #2e7d32;">👶 Child Questions (Minimum 1 required)</h5>
                                <div id="bank-children-container">
                                    <!-- Child questions will be added here dynamically -->
                                </div>
                                <button type="button" id="bank-add-child-btn" style="background: #4caf50; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; width: 100%; margin-top: 10px; font-weight: 600;">
                                    ➕ Add Another Child Question
                                </button>
                            </div>

                            <button id="add-parent-child-btn" style="background: var(--primary); color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; width: 100%; font-weight: 600; font-size: 1rem;">
                                Create Parent-child Question Set
                            </button>
                        </div>
                        <div class="error" id="question-error"></div>
                        <div class="success" id="question-success"></div>
                    </div>

                    <!-- Existing Questions List -->
                    <div>
                        <h4 style="margin: 20px 0 15px; color: var(--secondary);">Existing Questions</h4>
                        <div id="questions-list" style="max-height: 70vh; overflow-y: auto; padding-right: 5px;">
                            <p style="text-align: center; color: #7f8c8d;">Loading questions from database...</p>
                        </div>
                        <div id="questions-loading-more" style="display: none; text-align: center; padding: 20px;">
                            <div style="display: inline-block; width: 30px; height: 30px; border: 3px solid #f3f3f3; border-top: 3px solid var(--secondary); border-radius: 50%; animation: spin 1s linear infinite;"></div>
                            <p style="margin-top: 10px; color: #7f8c8d;">Loading more questions...</p>
                        </div>
                    </div>
                </div>

                <!-- Create Exam Section -->
                <div id="create-exam-section" class="hidden">
                    <h3 style="margin-bottom: 15px; color: var(--secondary);">New Exam Setup</h3>
                    <div class="form-group">
                        <label>Exam Code (Unique)</label>
                        <input type="text" id="exam-code" placeholder="e.g., REASONING_JULY_01" value="SAMPLE01">
                    </div>
                    <div class="form-group">
                        <label>Exam Title</label>
                        <input type="text" id="exam-title" placeholder="e.g., Logical Reasoning Test for Banking" value="Sample Exam">
                    </div>
                    <div class="form-group">
                        <label>Duration (Minutes)</label>
                        <input type="number" id="exam-duration" min="5" value="10" placeholder="e.g., 60">
                    </div>
                    <div class="form-group">
                        <label>Expiry Date (IST)</label>
                        <input type="text" id="exam-expiry" placeholder="Select or enter date (dd-mm-yyyy)">
                    </div>
                    <div class="form-group">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 10px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; flex-wrap: wrap; gap: 10px;">
                            <label style="margin: 0; color: white; font-size: 1.1rem; font-weight: 600;">Select Questions for Exam</label>
                            <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                                <div style="display: flex; align-items: center; gap: 5px; background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 8px;">
                                    <input type="number" id="random-count" min="1" value="5" placeholder="#" style="width: 60px; padding: 5px; border: none; border-radius: 5px; text-align: center; font-weight: 600;">
                                    <button id="random-select-btn" style="background: #f39c12; color: white; padding: 6px 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem; white-space: nowrap;">
                                        🎲 Random
                                    </button>
                                </div>
                                <button id="show-cart-btn" style="background: #27ae60; color: white; padding: 6px 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem; white-space: nowrap; display: flex; align-items: center; gap: 5px;">
                                    🛒 Cart (<span id="exam-cart-count">0</span>)
                                </button>
                                <button id="reset-selection-btn" style="background: #e74c3c; color: white; padding: 6px 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem; white-space: nowrap;">
                                    🔄 Reset
                                </button>
                                <div id="selected-count" style="background: white; color: #667eea; padding: 8px 20px; border-radius: 25px; font-weight: 700; font-size: 1.1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.2); min-width: 120px; text-align: center;">
                                    0 Selected
                                </div>
                            </div>
                        </div>
                        <!-- Filter controls for exam question selector -->
                        <div id="exam-question-filters" style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                            <input type="text" id="exam-question-search" placeholder="🔍 Search questions..." style="flex: 1; min-width: 180px; padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.95rem;">
                            <select id="exam-question-filter-subject" style="padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.95rem; min-width: 120px;">
                                <option value="">All Subjects</option>
                                <option value="Quantitative Aptitude">Quantitative Aptitude</option>
                                <option value="Reasoning Ability">Reasoning Ability</option>
                                <option value="English Language">English Language</option>
                                <option value="General Awareness">General Awareness</option>
                                <option value="Current Affairs">Current Affairs</option>
                                <option value="History">History</option>
                                <option value="Geography">Geography</option>
                                <option value="Political Science">Political Science</option>
                                <option value="Economics">Economics</option>
                                <option value="Constitution">Constitution</option>
                                <option value="Law">Law</option>
                                <option value="Mathematics">Mathematics</option>
                                <option value="Science">Science</option>
                                <option value="Polity">Polity</option>
                                <option value="Banking Awareness">Banking Awareness</option>
                                <option value="Computer Knowledge">Computer Knowledge</option>
                                <option value="Descriptive Writing">Descriptive Writing</option>
                                <option value="Data Interpretation">Data Interpretation</option>
                                <option value="Logical Reasoning">Logical Reasoning</option>
                                <option value="Analytical Ability">Analytical Ability</option>
                                <option value="Verbal Ability">Verbal Ability</option>
                                <option value="Technical Subjects">Technical Subjects</option>
                                <option value="Legal Reasoning">Legal Reasoning</option>
                                <option value="Pedagogy">Pedagogy</option>
                                <option value="Others">Others</option>
                            </select>
                            <select id="exam-question-filter-difficulty" style="padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.95rem; min-width: 120px;">
                                <option value="">All Difficulty</option>
                                <option value="Easy">Easy</option>
                                <option value="Medium">Medium</option>
                                <option value="Hard">Hard</option>
                            </select>
                        </div>
                        <div id="exam-questions-list">
                            <p style="text-align: center; color: #7f8c8d;">Loading questions from database...</p>
                        </div>
                    </div>
                    <button id="create-exam-submit-btn">Create Exam</button>
                    <div class="error" id="exam-error"></div>
                    <div class="success" id="exam-success"></div>
                </div>

                <!-- Cart Modal -->
                <div id="cart-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; overflow-y: auto;">
                    <div style="background: white; margin: 30px auto; max-width: 800px; border-radius: 12px; padding: 25px; position: relative; max-height: 90vh; overflow-y: auto;">
                        <button id="close-cart-modal-btn" style="position: absolute; top: 15px; right: 15px; background: var(--danger); color: white; border: none; padding: 10px 18px; border-radius: 8px; cursor: pointer; font-weight: 600; z-index: 10;">✖ Close</button>

                        <h3 style="color: var(--secondary); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.5rem;">🛒</span> Question Cart
                        </h3>

                        <!-- Cart Stats Summary -->
                        <div id="cart-stats-summary" style="margin-bottom: 20px;">
                            <!-- Stats will be populated by JavaScript -->
                        </div>

                        <!-- Cart Action Buttons -->
                        <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                            <button id="cart-select-all-btn" style="background: #3498db; color: white; padding: 8px 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                ☑️ Select All
                            </button>
                            <button id="cart-deselect-all-btn" style="background: #95a5a6; color: white; padding: 8px 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                ☐ Deselect All
                            </button>
                            <button id="cart-clear-btn" style="background: #e74c3c; color: white; padding: 8px 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                🗑️ Clear Cart
                            </button>
                        </div>

                        <!-- Cart Questions List -->
                        <div id="cart-questions-list" style="max-height: 400px; overflow-y: auto; margin-bottom: 20px; border: 1px solid #e0e0e0; border-radius: 8px;">
                            <!-- Questions will be populated by JavaScript -->
                        </div>

                        <!-- Add to Exam Button -->
                        <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 15px; border-top: 2px solid #e0e0e0;">
                            <span id="cart-selected-info" style="color: #666; font-weight: 500;">0 questions selected</span>
                            <button id="add-cart-to-exam-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; font-weight: 700; font-size: 1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.2);">
                                ➕ Add Selected to Exam
                            </button>
                        </div>
                    </div>
                </div>

                <!-- View Results Section -->
                <div id="view-results-section" class="hidden">
                    <div id="results-main-view">
                        <h3 style="margin-bottom: 20px; color: var(--secondary); display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.5rem;">📊</span> Exam Results Dashboard
                        </h3>
                        <div id="results-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 25px;">
                            <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 12px; text-align: center;">
                                <div style="font-size: 2rem; font-weight: 700;" id="total-exams-count">0</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Total Exams</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #11998e, #38ef7d); color: white; padding: 20px; border-radius: 12px; text-align: center;">
                                <div style="font-size: 2rem; font-weight: 700;" id="active-exams-count">0</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Active Exams</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #eb3349, #f45c43); color: white; padding: 20px; border-radius: 12px; text-align: center;">
                                <div style="font-size: 2rem; font-weight: 700;" id="expired-exams-count">0</div>
                                <div style="font-size: 0.9rem; opacity: 0.9;">Expired Exams</div>
                            </div>
                        </div>
                        <h4 style="margin-bottom: 15px; color: var(--primary);">Click on an exam to view candidates</h4>
                        <div id="exams-grid-container" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px;">
                            <p style="text-align: center; color: #7f8c8d; grid-column: 1/-1;">Loading exams...</p>
                        </div>
                    </div>

                    <div id="results-candidates-view" class="hidden">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <button id="back-to-exams-btn" style="background: var(--secondary); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <span>←</span> Back to Exams
                            </button>
                            <h3 style="color: var(--secondary); margin: 0;" id="selected-exam-title">Exam Results</h3>
                        </div>
                        <div id="selected-exam-info" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 20px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid var(--secondary);">
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h4 style="color: var(--primary); margin: 0;">Candidates who took this exam</h4>
                            <button id="export-results-btn-new" style="background: #27ae60; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                📥 Export to CSV
                            </button>
                        </div>
                        <div id="candidates-grid-container" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
                            <p style="text-align: center; color: #7f8c8d; grid-column: 1/-1;">Loading candidates...</p>
                        </div>
                    </div>

                    <div id="results-detail-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; overflow-y: auto;">
                        <div style="background: white; margin: 30px auto; max-width: 950px; border-radius: 12px; padding: 30px; position: relative; max-height: 90vh; overflow-y: auto;">
                            <button id="close-detail-modal-btn" style="position: absolute; top: 15px; right: 15px; background: var(--danger); color: white; border: none; padding: 10px 18px; border-radius: 8px; cursor: pointer; font-weight: 600; z-index: 10;">✖ Close</button>
                            <div id="results-detail-content"></div>
                        </div>
                    </div>
                </div>

                <!-- Create Question Section -->
                <div id="create-question-section" class="content-section" style="display: none;">
                    <h3 style="margin: 0 0 20px 0; color: var(--secondary);">➕ Create New Question</h3>
                    
                    <!-- Question Type Selector -->
                    <div class="form-group">
                        <label for="question-type-select">Question Type:</label>
                        <select id="question-type-select" style="padding: 12px; font-size: 16px;">
                            <option value="">-- Select Type --</option>
                            <option value="standalone">Standalone Question (Single MCQ)</option>
                            <option value="parent-child">Parent-Child Question (Passage/Scenario with Sub-Questions)</option>
                        </select>
                    </div>

                    <!-- Standalone Question Form -->
                    <div id="standalone-form" style="display: none; margin-top: 20px;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid var(--secondary);">
                            <h4 style="margin-top: 0; color: var(--secondary);">Standalone Question</h4>
                            
                            <div class="form-group">
                                <label>Question ID:</label>
                                <input type="text" id="standalone-id" placeholder="e.g., Q0001 (auto-generated if empty)">
                            </div>

                            <div class="form-group">
                                <label>Subject:</label>
                                <select id="standalone-subject">
                                    <option value="">-- Select Subject --</option>
                                    <option value="Quantitative Aptitude">Quantitative Aptitude</option>
                                    <option value="Reasoning Ability">Reasoning Ability</option>
                                    <option value="English Language">English Language</option>
                                    <option value="General Awareness">General Awareness</option>
                                    <option value="Current Affairs">Current Affairs</option>
                                    <option value="History">History</option>
                                    <option value="Geography">Geography</option>
                                    <option value="Political Science">Political Science</option>
                                    <option value="Economics">Economics</option>
                                    <option value="Constitution">Constitution</option>
                                    <option value="Law">Law</option>
                                    <option value="Mathematics">Mathematics</option>
                                    <option value="Science">Science</option>
                                    <option value="Polity">Polity</option>
                                    <option value="Banking Awareness">Banking Awareness</option>
                                    <option value="Computer Knowledge">Computer Knowledge</option>
                                    <option value="Data Interpretation">Data Interpretation</option>
                                    <option value="Logical Reasoning">Logical Reasoning</option>
                                    <option value="Technical Subjects">Technical Subjects</option>
                                    <option value="Legal Reasoning">Legal Reasoning</option>
                                    <option value="Others">Others</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Question:</label>
                                <textarea id="standalone-question" rows="3" placeholder="Enter your question here..."></textarea>
                            </div>

                            <div class="form-group">
                                <label>Option A:</label>
                                <input type="text" id="standalone-option-a" placeholder="Enter option A">
                            </div>

                            <div class="form-group">
                                <label>Option B:</label>
                                <input type="text" id="standalone-option-b" placeholder="Enter option B">
                            </div>

                            <div class="form-group">
                                <label>Option C:</label>
                                <input type="text" id="standalone-option-c" placeholder="Enter option C">
                            </div>

                            <div class="form-group">
                                <label>Option D:</label>
                                <input type="text" id="standalone-option-d" placeholder="Enter option D">
                            </div>

                            <div class="form-group">
                                <label>Correct Answer:</label>
                                <select id="standalone-correct">
                                    <option value="">-- Select Correct Answer --</option>
                                    <option value="A">A</option>
                                    <option value="B">B</option>
                                    <option value="C">C</option>
                                    <option value="D">D</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Difficulty:</label>
                                <select id="standalone-difficulty">
                                    <option value="Easy">Easy</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Hard">Hard</option>
                                </select>
                            </div>

                            <button class="btn primary-btn" id="create-standalone-btn" style="width: 100%; margin-top: 10px;">
                                Create Standalone Question
                            </button>
                        </div>
                    </div>

                    <!-- Parent-Child Question Form -->
                    <div id="parent-child-form" style="display: none; margin-top: 20px;">
                        
                        <!-- Parent Question Section -->
                        <div style="background: #fff3cd; padding: 20px; border-radius: 10px; border-left: 4px solid #ffc107; margin-bottom: 20px;">
                            <h4 style="margin-top: 0; color: #856404;">📖 Parent Question (Passage/Scenario)</h4>
                            <p style="color: #856404; font-size: 14px; margin-bottom: 15px;">
                                This is the main passage, scenario, or context that children questions will refer to. It will NOT be scored itself.
                            </p>

                            <div class="form-group">
                                <label>Parent ID:</label>
                                <input type="text" id="parent-id" placeholder="e.g., Q0001 (auto-generated if empty)">
                            </div>

                            <div class="form-group">
                                <label>Subject:</label>
                                <select id="parent-subject">
                                    <option value="">-- Select Subject --</option>
                                    <option value="Quantitative Aptitude">Quantitative Aptitude</option>
                                    <option value="Reasoning Ability">Reasoning Ability</option>
                                    <option value="English Language">English Language</option>
                                    <option value="General Awareness">General Awareness</option>
                                    <option value="Current Affairs">Current Affairs</option>
                                    <option value="History">History</option>
                                    <option value="Geography">Geography</option>
                                    <option value="Political Science">Political Science</option>
                                    <option value="Economics">Economics</option>
                                    <option value="Constitution">Constitution</option>
                                    <option value="Law">Law</option>
                                    <option value="Mathematics">Mathematics</option>
                                    <option value="Science">Science</option>
                                    <option value="Polity">Polity</option>
                                    <option value="Banking Awareness">Banking Awareness</option>
                                    <option value="Computer Knowledge">Computer Knowledge</option>
                                    <option value="Data Interpretation">Data Interpretation</option>
                                    <option value="Logical Reasoning">Logical Reasoning</option>
                                    <option value="Technical Subjects">Technical Subjects</option>
                                    <option value="Legal Reasoning">Legal Reasoning</option>
                                    <option value="Others">Others</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Parent Question Text (Passage/Scenario):</label>
                                <textarea id="parent-text" rows="8" placeholder="Enter the full passage, scenario, or context here...

Example:
Read the following passage about artificial intelligence:

Artificial Intelligence has revolutionized..."></textarea>
                            </div>

                            <div class="form-group">
                                <label>Difficulty:</label>
                                <select id="parent-difficulty">
                                    <option value="Easy">Easy</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Hard">Hard</option>
                                </select>
                            </div>
                        </div>

                        <!-- Children Questions Section -->
                        <div style="background: #d1ecf1; padding: 20px; border-radius: 10px; border-left: 4px solid #17a2b8;">
                            <h4 style="margin-top: 0; color: #0c5460;">👶 Child Questions (Minimum 1 Required)</h4>
                            <p style="color: #0c5460; font-size: 14px; margin-bottom: 15px;">
                                These are the actual questions that refer to the parent passage/scenario. Each will be scored individually.
                            </p>

                            <div id="children-container">
                                <!-- Child questions will be added here dynamically -->
                            </div>

                            <button class="btn" id="add-child-btn" style="background: #17a2b8; color: white; width: 100%; margin-top: 15px;">
                                ➕ Add Another Child Question
                            </button>
                        </div>

                        <!-- Submit Button -->
                        <button class="btn primary-btn" id="create-parent-child-btn" style="width: 100%; margin-top: 20px; padding: 15px; font-size: 18px;">
                            ✅ Create Parent-Child Question Set
                        </button>
                    </div>

                    <!-- Back Button -->
                    <button class="btn" id="back-from-create-btn" style="background: #6c757d; color: white; width: 100%; margin-top: 20px;">
                        ⬅ Back to Dashboard
                    </button>
                </div>

                <!-- Upload Question Paper Section -->
                <div id="upload-section" class="hidden">
                    <h3>📸 Upload Question Paper</h3>
                    <p>Capture questions directly with your camera or upload an existing image/PDF!</p>

                    <div style="display: flex; gap: 15px; margin: 20px 0; flex-wrap: wrap;">
                        <button class="upload-btn" id="capture-photo-btn" style="flex: 1; min-width: 200px;">
                            📷 Capture with Camera
                        </button>
                        <button class="admin-btn" id="choose-file-btn" style="flex: 1; min-width: 200px;">
                            📁 Choose from Files
                        </button>
                    </div>

                    <div class="form-group" style="margin-top: 10px;">
                        <input type="file" id="paper-upload" accept="image/*,.pdf" capture="environment" style="display: none;">
                        <input type="file" id="paper-upload-file" accept="image/*,.pdf" style="display: none;">
                        <div id="selected-file-info" class="hidden" style="padding: 12px; background: #e8f5e9; border-radius: 8px; margin-top: 10px;">
                            <strong>Selected:</strong> <span id="file-name"></span>
                        </div>
                    </div>

                    <button class="upload-btn" id="process-upload-btn">🤖 Extract Questions with Gemini AI</button>
                    <div id="ocr-progress" class="hidden" style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 8px; text-align: center;">
                        <p style="color: var(--secondary); font-weight: 600; margin-bottom: 10px;">Processing with Gemini AI...</p>
                        <div style="background: #ddd; border-radius: 10px; overflow: hidden; height: 20px;">
                            <div id="ocr-progress-bar" style="background: var(--secondary); height: 100%; width: 0%; transition: width 0.3s;"></div>
                        </div>
                        <p id="ocr-status" style="margin-top: 10px; font-size: 0.9rem; color: #666;"></p>
                    </div>
                    
                    <div id="upload-result-container" class="hidden" style="margin-top: 25px; padding: 20px; background: white; border-radius: 12px; border: 1px solid #e0e0e0;">
                        <h4 style="color: var(--primary); margin-bottom: 15px;">Extracted Text</h4>
                        <textarea id="extracted-text" rows="10" style="font-family: monospace; margin-bottom: 20px; resize: vertical;"></textarea>
                        
                        <button class="admin-btn" style="margin-bottom: 15px;" id="clean-text-btn">🧹 Clean & Format Text</button>
                        
                        <h4 style="margin: 20px 0 15px; color: var(--secondary);">Ready to Add Questions</h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px; flex-wrap: wrap;">
                            <button class="admin-btn" id="select-all-extracted-btn" style="background: #2196f3;">☑️ Select All</button>
                            <button class="admin-btn" id="select-none-extracted-btn" style="background: #9e9e9e;">☐ Select None</button>
                        </div>
                        <div id="ready-questions">
                            <p style="text-align: center; color: #7f8c8d;">Click 'Clean & Format Text' to see questions</p>
                        </div>

                        <div style="display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
                            <button class="success-btn" id="add-extracted-btn">✅ Add All Questions to Bank</button>
                            <button class="admin-btn" id="add-selected-btn">➕ Add Selected Questions</button>
                        </div>
                    </div>
                </div>

                <!-- AI Question Generator Section -->
                <div id="ai-generator-section" class="hidden">
                    <h3>🤖 AI Question Generator</h3>
                    <p>Create high-quality MCQs in seconds with AI. Perfect for job aspirants!</p>

                    <div class="form-group" style="margin-top: 20px;">
                        <label>Subject Category</label>
                        <select id="ai-subject">
                            <option value="Quantitative Aptitude">Quantitative Aptitude</option>
                            <option value="Reasoning Ability">Reasoning Ability</option>
                            <option value="English Language">English Language</option>
                            <option value="General Awareness">General Awareness</option>
                            <option value="Current Affairs">Current Affairs</option>
                            <option value="History">History</option>
                            <option value="Geography">Geography</option>
                            <option value="Political Science">Political Science</option>
                            <option value="Economics">Economics</option>
                            <option value="Constitution">Constitution</option>
                            <option value="Law">Law</option>
                            <option value="Mathematics">Mathematics</option>
                            <option value="Polity">Polity</option>
                            <option value="Science">Science</option>
                            <option value="Banking Awareness">Banking Awareness</option>
                            <option value="Computer Knowledge">Computer Knowledge</option>
                            <option value="Data Interpretation">Data Interpretation</option>
                            <option value="Logical Reasoning">Logical Reasoning</option>
                            <option value="Analytical Ability">Analytical Ability</option>
                            <option value="Verbal Ability">Verbal Ability</option>
                            <option value="Technical Subjects">Technical Subjects</option>
                            <option value="Legal Reasoning">Legal Reasoning</option>
                            <option value="Pedagogy">Pedagogy</option>
                            <option value="Others">Others</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Difficulty Level</label>
                        <select id="ai-difficulty">
                            <option value="easy">Easy (Railway Group D, SSC MTS)</option>
                            <option value="medium" selected>Medium (Bank Clerk, SSC CHSL)</option>
                            <option value="hard">Hard (Bank PO, SSC CGL)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Question Format</label>
                        <select id="ai-question-format">
                            <option value="standalone">Standalone (Single Question)</option>
                            <option value="parent-child">Parent-Child (Passage + Sub-Questions)</option>
                        </select>
                        <p style="font-size: 0.85rem; color: #7f8c8d; margin-top: 5px;">💡 Parent-Child format creates a passage/context with multiple related questions (like Reading Comprehension, Data Interpretation)</p>
                    </div>

                    <div class="form-group" id="sub-questions-count-group" style="display: none;">
                        <label>Number of Sub-Questions</label>
                        <select id="ai-sub-questions-count">
                            <option value="3" selected>3 Questions</option>
                            <option value="4">4 Questions</option>
                            <option value="5">5 Questions</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Custom Prompt (Optional)</label>
                        <textarea id="ai-custom-prompt" rows="3" placeholder="Example: Generate questions for Railway Clerk exam on quantitative aptitude&#10;OR: Generate reading comprehension passage about Indian economy&#10;&#10;Leave empty to auto-generate based on subject and difficulty"></textarea>
                        <p style="font-size: 0.85rem; color: #7f8c8d; margin-top: 5px;">💡 Add specific instructions like exam type (Railway, Banking, SSC), topic focus</p>
                    </div>

                    <button class="ai-btn" id="generate-ai-btn">✨ Generate Question with AI</button>
                    <div class="error" id="ai-error"></div>
                    
                    <!-- Standalone Question Result -->
                    <div id="ai-result-container" class="hidden" style="margin-top: 25px; padding: 20px; background: white; border-radius: 12px; border: 1px solid #e0e0e0;">
                        <h4 style="color: var(--primary); margin-bottom: 10px;">AI Generated Question</h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <span class="question-tag" id="ai-display-subject">Subject</span>
                            <span class="question-tag" id="ai-display-difficulty" style="background: #e3f2fd;">Difficulty</span>
                        </div>
                        <div id="ai-question-text" style="font-weight: 500; margin-bottom: 15px; font-size: 1.05rem;"></div>

                        <div style="margin-left: 25px; margin-bottom: 15px;">
                            <div>A) <span id="ai-option-a"></span></div>
                            <div>B) <span id="ai-option-b"></span></div>
                            <div>C) <span id="ai-option-c"></span></div>
                            <div>D) <span id="ai-option-d"></span></div>
                        </div>

                        <div style="background: #e8f5e9; padding: 12px; border-radius: 8px; margin: 15px 0;">
                            <strong>Correct Answer:</strong> <span id="ai-correct-answer"></span><br>
                            <strong>Explanation:</strong> <span id="ai-explanation"></span>
                        </div>

                        <div style="display: flex; gap: 15px; margin-top: 20px;">
                            <button class="success-btn" style="flex: 1;" id="accept-ai-btn">Accept & Add to Bank</button>
                            <button class="admin-btn" style="flex: 1;" id="regenerate-ai-btn">Generate New Question</button>
                        </div>
                    </div>

                    <!-- Parent-Child Question Result -->
                    <div id="ai-parent-child-result" class="hidden" style="margin-top: 25px; padding: 20px; background: white; border-radius: 12px; border: 2px solid #17a2b8;">
                        <h4 style="color: #0c5460; margin-bottom: 10px;">AI Generated Passage-Based Questions</h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <span class="question-tag" id="ai-pc-subject">Subject</span>
                            <span class="question-tag" id="ai-pc-difficulty" style="background: #e3f2fd;">Difficulty</span>
                            <span class="question-tag" style="background: #d1ecf1; color: #0c5460;">Parent-Child</span>
                        </div>

                        <!-- Main Passage -->
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #17a2b8;">
                            <h5 style="margin: 0 0 10px 0; color: #0c5460;">Main Passage / Context:</h5>
                            <div id="ai-pc-passage" style="line-height: 1.6; white-space: pre-wrap;"></div>
                        </div>

                        <!-- Sub Questions Container -->
                        <div id="ai-pc-subquestions-container">
                            <!-- Sub-questions will be rendered here by JavaScript -->
                        </div>

                        <div style="display: flex; gap: 15px; margin-top: 20px;">
                            <button class="success-btn" style="flex: 1;" id="accept-ai-pc-btn">Accept & Add All to Bank</button>
                            <button class="admin-btn" style="flex: 1;" id="regenerate-ai-pc-btn">Generate New Set</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Candidate Login Screen -->
            <div id="candidate-login-screen" class="screen">
                <div class="card bg-base-100 shadow-2xl max-w-2xl mx-auto">
                    <div class="card-body">
                        <div class="text-center mb-6">
                            <div class="text-7xl mb-4">📝</div>
                            <h2 class="card-title text-3xl font-bold text-primary justify-center">Start Your Exam</h2>
                            <p class="text-base-content/70 mt-2">Fill in your details to begin the assessment</p>
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Select Exam</span>
                            </label>
                            <select id="exam-code-input" class="select select-bordered select-primary w-full">
                                <option value="">-- Select an Active Exam --</option>
                            </select>
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Your Full Name</span>
                            </label>
                            <input type="text" id="candidate-name" placeholder="As per your application" class="input input-bordered input-primary">
                        </div>
                        <div class="form-control">
                            <label class="label">
                                <span class="label-text font-semibold">Mobile Number *</span>
                            </label>
                            <input type="tel" id="candidate-mobile" placeholder="Enter your 10-digit mobile number" class="input input-bordered input-primary" required>
                        </div>
                        <p class="error text-error text-sm text-center mt-2" id="login-error"></p>
                        <div class="form-control mt-6">
                            <button id="start-exam-btn" class="btn btn-success btn-lg text-white gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                                Begin Exam
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Exam Screen -->
            <div id="exam-screen" class="screen">
                <!-- Floating Timer -->
                <div class="timer" id="timer-display">⏱️ Time Remaining: 10:00</div>

                <!-- Dynamic Question Container - supports both standalone and parent-child groups -->
                <div id="exam-question-container">
                    <!-- Standalone question template (default) -->
                    <div class="question-container" id="standalone-question-container">
                        <div class="question-tag" id="question-subject-display">Reasoning</div>
                        <div class="question-number">Question <span id="current-q-num">1</span> of <span id="total-questions">5</span></div>
                        <div class="question-text" id="question-text-display">Loading question...</div>

                        <div class="options" id="standalone-options">
                            <div class="option" data-index="0">
                                <input type="radio" name="exam-answer" class="option-radio" id="option-radio-0">
                                <span class="option-letter">A</span>
                                <span id="option-a-display">Loading...</span>
                            </div>
                            <div class="option" data-index="1">
                                <input type="radio" name="exam-answer" class="option-radio" id="option-radio-1">
                                <span class="option-letter">B</span>
                                <span id="option-b-display">Loading...</span>
                            </div>
                            <div class="option" data-index="2">
                                <input type="radio" name="exam-answer" class="option-radio" id="option-radio-2">
                                <span class="option-letter">C</span>
                                <span id="option-c-display">Loading...</span>
                            </div>
                            <div class="option" data-index="3">
                                <input type="radio" name="exam-answer" class="option-radio" id="option-radio-3">
                                <span class="option-letter">D</span>
                                <span id="option-d-display">Loading...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Parent-Child Group Container (hidden by default, shown for grouped questions) -->
                    <div id="parent-child-question-container" style="display: none;">
                        <!-- Will be dynamically populated with passage + all sub-questions -->
                    </div>
                </div>

                <div class="progress">Question <span id="progress-num">1</span> of <span id="progress-total">5</span></div>

                <div class="navigation">
                    <button id="prev-btn" disabled>← Previous</button>
                    <button id="next-btn">Next →</button>
                    <button id="submit-btn" class="success-btn" style="display: none;">Submit Exam</button>
                </div>
            </div>

            <!-- Result Screen -->
            <div id="result-screen" class="screen">
                <div class="card bg-base-100 shadow-2xl max-w-2xl mx-auto">
                    <div class="card-body text-center">
                        <div class="text-8xl mb-6">✅</div>
                        <h2 class="card-title text-4xl font-bold text-success justify-center mb-4">Exam Completed!</h2>
                        <p class="text-lg text-base-content/70 mb-6">
                            Thank you for attempting Polite Coaching Centre test.
                        </p>

                        <!-- Score Display -->
                        <div class="stats shadow-xl mb-6 bg-gradient-to-br from-success to-success-content text-white">
                            <div class="stat">
                                <div class="stat-title text-white/80">Your Final Score</div>
                                <div class="stat-value text-6xl" id="final-score">0.00</div>
                                <div class="stat-desc text-white/70">Out of 100</div>
                            </div>
                        </div>

                        <!-- Exam Details -->
                        <div class="bg-base-200 rounded-lg p-6 mb-6 text-left">
                            <div class="space-y-3">
                                <div class="flex items-center gap-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    <div>
                                        <span class="font-semibold">Exam Code:</span>
                                        <span class="ml-2" id="result-exam-code">REASONING_01</span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                    <div>
                                        <span class="font-semibold">Name:</span>
                                        <span class="ml-2" id="result-name">Candidate Name</span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                    </svg>
                                    <div>
                                        <span class="font-semibold">Mobile:</span>
                                        <span class="ml-2" id="result-mobile">9876543210</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-success mb-6">
                            <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                            <span>Your score has been recorded successfully.</span>
                        </div>

                        <button class="btn btn-primary btn-lg gap-2" id="result-logout-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                            </svg>
                            Log Out / Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div class="notification-container" id="notification-container"></div>

    <!-- Image Lightbox for full-size image viewing -->
    <div id="image-lightbox" class="image-lightbox" onclick="closeLightbox()">
        <span class="image-lightbox-close" onclick="closeLightbox()">&times;</span>
        <img id="lightbox-image" src="" alt="Full size image">
    </div>

    <!-- Math & Image Syntax Help Modal -->
    <div id="math-syntax-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; justify-content: center; align-items: center; padding: 20px;">
        <div style="background: white; border-radius: 15px; max-width: 800px; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <!-- Header -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 25px; border-radius: 15px 15px 0 0; position: sticky; top: 0; z-index: 1;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="margin: 0; font-size: 1.3rem;">📐 Math, Image & Graph Syntax Guide</h3>
                    <button id="close-math-syntax-modal" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 1.5rem; cursor: pointer; padding: 5px 12px; border-radius: 8px;">&times;</button>
                </div>
                <p style="margin: 8px 0 0 0; opacity: 0.9; font-size: 0.9rem;">Use these formats in Question Text and Options</p>
            </div>

            <!-- Content -->
            <div style="padding: 25px;">
                <!-- SIMPLE SYNTAX Section - Most Important! -->
                <div style="margin-bottom: 25px; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 20px; border-radius: 12px; border: 2px solid #4caf50;">
                    <h4 style="color: #2e7d32; margin: 0 0 15px 0; display: flex; align-items: center; gap: 8px; font-size: 1.2rem;">
                        <span style="font-size: 1.5rem;">✨</span>
                        Easy Syntax (Recommended!)
                        <span style="background: #4caf50; color: white; padding: 3px 10px; border-radius: 15px; font-size: 0.75rem; margin-left: auto;">Auto-converts</span>
                    </h4>
                    <p style="margin: 0 0 15px 0; color: #1b5e20; font-size: 0.95rem;">Just type naturally - the system will automatically convert to proper math notation!</p>

                    <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem; background: white; border-radius: 8px; overflow: hidden;">
                        <thead>
                            <tr style="background: #4caf50; color: white;">
                                <th style="padding: 10px; text-align: left;">What You Want</th>
                                <th style="padding: 10px; text-align: left;">Just Type</th>
                                <th style="padding: 10px; text-align: left;">Result</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #f1f8e9;"><td style="padding: 10px;">Two squared</td><td style="padding: 10px;"><code>2^2</code></td><td style="padding: 10px;">2²</td></tr>
                            <tr><td style="padding: 10px;">x to power 10</td><td style="padding: 10px;"><code>x^10</code></td><td style="padding: 10px;">x¹⁰</td></tr>
                            <tr style="background: #f1f8e9;"><td style="padding: 10px;">Subscript</td><td style="padding: 10px;"><code>x_1</code> or <code>a_n</code></td><td style="padding: 10px;">x₁, aₙ</td></tr>
                            <tr><td style="padding: 10px;">Square root</td><td style="padding: 10px;"><code>sqrt(x)</code> or <code>sqrt(a+b)</code></td><td style="padding: 10px;">√x, √(a+b)</td></tr>
                            <tr style="background: #f1f8e9;"><td style="padding: 10px;">Cube root</td><td style="padding: 10px;"><code>cbrt(8)</code></td><td style="padding: 10px;">³√8</td></tr>
                            <tr><td style="padding: 10px;">Fraction</td><td style="padding: 10px;"><code>1/2</code>, <code>3/4</code>, or <code>frac(a,b)</code></td><td style="padding: 10px;">½, ¾, a/b</td></tr>
                            <tr style="background: #f1f8e9;"><td style="padding: 10px;">Pi</td><td style="padding: 10px;"><code>pi</code> (with spaces around)</td><td style="padding: 10px;">π</td></tr>
                            <tr><td style="padding: 10px;">Greek letters</td><td style="padding: 10px;"><code>alpha</code>, <code>beta</code>, <code>theta</code></td><td style="padding: 10px;">α, β, θ</td></tr>
                            <tr style="background: #f1f8e9;"><td style="padding: 10px;">Comparisons</td><td style="padding: 10px;"><code>>=</code>, <code><=</code>, <code>!=</code></td><td style="padding: 10px;">≥, ≤, ≠</td></tr>
                            <tr><td style="padding: 10px;">Degrees</td><td style="padding: 10px;"><code>90deg</code></td><td style="padding: 10px;">90°</td></tr>
                            <tr style="background: #f1f8e9;"><td style="padding: 10px;">Plus/minus</td><td style="padding: 10px;"><code>+-</code></td><td style="padding: 10px;">±</td></tr>
                            <tr><td style="padding: 10px;">Infinity</td><td style="padding: 10px;"><code>infinity</code></td><td style="padding: 10px;">∞</td></tr>
                        </tbody>
                    </table>

                    <div style="margin-top: 15px; background: white; padding: 12px; border-radius: 8px; border-left: 4px solid #4caf50;">
                        <p style="margin: 0; font-weight: 600; color: #2e7d32;">Example Question:</p>
                        <code style="font-size: 0.9rem; color: #333; display: block; margin-top: 5px;">If x^2 + y^2 = 25 and x = 3, find y. (Use sqrt() for square root)</code>
                    </div>
                </div>

                <!-- Advanced LaTeX Section (Collapsible) -->
                <details style="margin-bottom: 25px;">
                    <summary style="cursor: pointer; color: #667eea; font-weight: 600; font-size: 1.1rem; padding: 10px; background: #f0f4ff; border-radius: 8px; display: flex; align-items: center; gap: 8px;">
                        <span style="background: #667eea; color: white; padding: 4px 10px; border-radius: 8px; font-size: 0.85rem;">Advanced</span>
                        LaTeX Syntax (for complex formulas)
                    </summary>
                    <div style="padding: 15px; border: 1px solid #e0e0e0; border-radius: 0 0 8px 8px; margin-top: -5px;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 10px;">
                            <p style="margin: 0 0 10px 0; font-weight: 600;">Format: Wrap formulas in $ signs</p>
                            <code style="background: #e9ecef; padding: 8px 12px; border-radius: 6px; display: block;">Inline: $formula$ &nbsp;&nbsp;|&nbsp;&nbsp; Display (centered): $$formula$$</code>
                        </div>

                        <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                            <thead>
                                <tr style="background: #667eea; color: white;">
                                    <th style="padding: 8px; text-align: left;">What You Want</th>
                                    <th style="padding: 8px; text-align: left;">LaTeX Code</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #f8f9fa;"><td style="padding: 8px;">Complex fraction</td><td style="padding: 8px;"><code>$\frac{a+b}{c-d}$</code></td></tr>
                                <tr><td style="padding: 8px;">nth root</td><td style="padding: 8px;"><code>$\sqrt[3]{8}$</code></td></tr>
                                <tr style="background: #f8f9fa;"><td style="padding: 8px;">Sum (Sigma)</td><td style="padding: 8px;"><code>$\sum_{i=1}^{n} i$</code></td></tr>
                                <tr><td style="padding: 8px;">Integral</td><td style="padding: 8px;"><code>$\int_0^1 x \, dx$</code></td></tr>
                                <tr style="background: #f8f9fa;"><td style="padding: 8px;">Multiply/Divide</td><td style="padding: 8px;"><code>$\times$, $\div$</code></td></tr>
                            </tbody>
                        </table>
                    </div>
                </details>

                <!-- Images Section -->
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #27ae60; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span style="background: #27ae60; color: white; padding: 4px 10px; border-radius: 8px;">2</span>
                        Images
                    </h4>
                    <div style="background: #e8f5e9; padding: 15px; border-radius: 10px;">
                        <p style="margin: 0 0 10px 0; font-weight: 600;">Format:</p>
                        <code style="background: #c8e6c9; padding: 8px 12px; border-radius: 6px; display: block; margin-bottom: 10px;">[img:https://your-image-url.com/image.png]</code>
                        <p style="margin: 0; font-size: 0.9rem; color: #2e7d32;">
                            <strong>Example:</strong> [img:https://i.imgur.com/example.png]<br>
                            <strong>Tip:</strong> Upload images to Imgur, Google Drive (public), or any image hosting service and use the direct URL.
                        </p>
                    </div>
                </div>

                <!-- Graphs Section -->
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #f39c12; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span style="background: #f39c12; color: white; padding: 4px 10px; border-radius: 8px;">3</span>
                        Graphs & Charts
                    </h4>
                    <div style="background: #fff8e1; padding: 15px; border-radius: 10px;">
                        <p style="margin: 0 0 10px 0; font-weight: 600;">Format:</p>
                        <code style="background: #ffecb3; padding: 8px 12px; border-radius: 6px; display: block; margin-bottom: 10px;">[graph:type:label1,value1;label2,value2;label3,value3]</code>
                        <p style="margin: 0 0 8px 0; font-size: 0.9rem;"><strong>Types:</strong> line, bar, pie, doughnut</p>
                        <p style="margin: 0; font-size: 0.9rem; color: #e65100;">
                            <strong>Examples:</strong><br>
                            • Bar chart: <code>[graph:bar:Jan,100;Feb,150;Mar,200]</code><br>
                            • Pie chart: <code>[graph:pie:Pass,75;Fail,25]</code><br>
                            • Line graph: <code>[graph:line:2020,50;2021,75;2022,100]</code>
                        </p>
                    </div>
                </div>

                <!-- Tables Section -->
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #9c27b0; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                        <span style="background: #9c27b0; color: white; padding: 4px 10px; border-radius: 8px;">4</span>
                        Tables
                    </h4>
                    <div style="background: #f3e5f5; padding: 15px; border-radius: 10px;">
                        <p style="margin: 0 0 10px 0; font-weight: 600;">Format:</p>
                        <code style="background: #e1bee7; padding: 8px 12px; border-radius: 6px; display: block; margin-bottom: 10px;">[table:Header1,Header2|Row1Col1,Row1Col2|Row2Col1,Row2Col2]</code>
                        <p style="margin: 0; font-size: 0.9rem; color: #7b1fa2;">
                            <strong>Example:</strong> <code>[table:Name,Score|Alice,85|Bob,92|Charlie,78]</code>
                        </p>
                    </div>
                </div>

                <!-- Example Questions -->
                <div style="background: linear-gradient(135deg, #e3f2fd 0%, #e8f5e9 100%); padding: 20px; border-radius: 10px; border: 2px dashed #667eea;">
                    <h4 style="color: #1565c0; margin: 0 0 15px 0;">Example Questions</h4>

                    <div style="background: white; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                        <p style="margin: 0 0 5px 0; font-weight: 600; color: #333;">Algebra Question:</p>
                        <code style="font-size: 0.85rem; color: #555;">Solve for $x$: $2x^2 + 5x - 3 = 0$</code>
                    </div>

                    <div style="background: white; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                        <p style="margin: 0 0 5px 0; font-weight: 600; color: #333;">Geometry Question:</p>
                        <code style="font-size: 0.85rem; color: #555;">Find the area of a circle with radius $r = 7$ cm. (Use $\pi = \frac{22}{7}$)</code>
                    </div>

                    <div style="background: white; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                        <p style="margin: 0 0 5px 0; font-weight: 600; color: #333;">Option with Math:</p>
                        <code style="font-size: 0.85rem; color: #555;">Option A: $x = \frac{-5 + \sqrt{49}}{4}$</code>
                    </div>

                    <div style="background: white; padding: 12px; border-radius: 8px;">
                        <p style="margin: 0 0 5px 0; font-weight: 600; color: #333;">Question with Image:</p>
                        <code style="font-size: 0.85rem; color: #555;">Based on the diagram: [img:https://example.com/triangle.png] Find angle $\theta$.</code>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- OCR Review Modal -->
    <div id="ocr-review-modal" class="ocr-review-modal">
        <div class="ocr-review-content">
            <div class="ocr-review-header">
                <h3 class="ocr-review-title">📝 Review Extracted Questions</h3>
                <button id="ocr-review-close" class="ocr-review-close">✖ Close</button>
            </div>
            <p style="color: #666; margin-bottom: 20px;">Review AI-detected questions below. <strong>You can change the question type</strong> (Standalone/Parent/Child) using the dropdown, and <strong>assign parent passages</strong> to child questions if the AI detection was incorrect.</p>
            <div id="ocr-review-questions">
                <!-- Questions will be dynamically inserted here -->
            </div>
            <div class="ocr-review-actions">
                <button id="ocr-cancel-review" class="ocr-cancel-btn">Cancel</button>
                <button id="ocr-save-reviewed" class="ocr-save-btn">✅ Save & Continue</button>
            </div>
        </div>
    </div>

    <!-- Main Application Script -->
    <script src="app.js"></script>

    
    <!-- Footer -->
    <footer style="background-color: var(--primary); color: white; padding: 20px; text-align: center; margin-top: 40px;">
        <div style="max-width: 900px; margin: 0 auto;">
            <p style="margin-bottom: 10px;">&copy; 2025 Polite Coaching Centre. All rights reserved.</p>
            <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                <a href="/docs/privacy-policy.html" style="color: #3498db; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#2980b9'" onmouseout="this.style.color='#3498db'">Privacy Policy</a>
                <span style="color: #95a5a6;">|</span>
                <a href="/docs/delete-account.html" style="color: #3498db; text-decoration: none; transition: color 0.3s;" onmouseover="this.style.color='#2980b9'" onmouseout="this.style.color='#3498db'">Delete Account</a>
            </div>
        </div>
    </footer>
    
    <!-- Service Worker Registration -->
    <script>
        // Register service worker for PWA functionality with update handling
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('Service Worker registered successfully:', registration.scope);

                    // Check for updates immediately
                    registration.update();

                    // Check for updates periodically (every 5 minutes)
                    setInterval(() => {
                        registration.update();
                        console.log('Checking for service worker updates...');
                    }, 5 * 60 * 1000);

                    // Handle updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        console.log('New service worker installing...');

                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // New content is available, refresh automatically
                                console.log('New version available, refreshing...');
                                window.location.reload();
                            }
                        });
                    });

                    // Handle controller change (when new SW takes over)
                    navigator.serviceWorker.addEventListener('controllerchange', () => {
                        console.log('New service worker activated');
                    });
                } catch (error) {
                    console.log('Service Worker registration failed:', error);
                }
            });
        }
    </script>
</body>
</html>
